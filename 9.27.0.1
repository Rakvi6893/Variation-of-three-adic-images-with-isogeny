// 9.27.0.1 x X0(2)


N:=18;
GL2:=GL(2,Integers(N));
G:=sub<GL2|[[7,5,4,1],[9,17,4,11]]>;
Grec:=CreateModularCurveRec(N,Generators(G));
Model:=FindModelOfXG(Grec,27)`psi;
x:=AssociativeArray();
P2:=ProjectiveSpace(Rationals(),3);
for i in [1..4] do;
    x[i]:=P2.i;
end for;
C:=Scheme(P2,Model);
C3:=Reduction(C,3);
P:=Points(C3);


  for a in Integers(27) do;
for b in Integers(27) do;
for c in Integers(27) do;
for d in Integers(27) do;
if Integers()!a mod 3 eq P[1][1] and Integers()!b mod 3 eq P[1][2] and Integers()!c mod 3 eq P[1][3] and Integers()!d mod 3 eq P[1][4] then
S:=[Evaluate(DefiningEquations(C)[i],[a,b,c,d]): i in [1..#DefiningEquations(C)]];
if Integers()!S[1] mod 27 eq 0 and Integers()!S[2] mod 27 eq 0 then [a,b,c,d];
end if;
else continue;
end if;
end for;end for;end for;end for;



for a in Integers(27) do;
for b in Integers(27) do;
for c in Integers(27) do;
for d in Integers(27) do;
if Integers()!a mod 3 eq P[2][1] and Integers()!b mod 3 eq P[2][2] and Integers()!c mod 3 eq P[2][3] and Integers()!d mod 3 eq P[2][4] then
S:=[Evaluate(DefiningEquations(C)[i],[a,b,c,d]): i in [1..#DefiningEquations(C)]];
if Integers()!S[1] mod 27 eq 0 and Integers()!S[2] mod 27 eq 0 then [a,b,c,d];
end if;
else continue;
end if;
end for;end for;end for;end for;



for a in Integers(9) do;
for b in Integers(9) do;
for c in Integers(9) do;
for d in Integers(9) do;
if Integers()!a mod 3 eq P[3][1] and Integers()!b mod 3 eq P[3][2] and Integers()!c mod 3 eq P[3][3] and Integers()!d mod 3 eq P[3][4] then
S:=[Evaluate(DefiningEquations(C)[i],[a,b,c,d]): i in [1..#DefiningEquations(C)]];
if Integers()!S[1] mod 9 eq 0 and Integers()!S[2] mod 9 eq 0 then [a,b,c,d];
end if;
else continue;
end if;
end for;end for;end for;end for;




for a in Integers(9) do;
for b in Integers(9) do;
for c in Integers(9) do;
for d in Integers(9) do;
if Integers()!a mod 3 eq P[4][1] and Integers()!b mod 3 eq P[4][2] and Integers()!c mod 3 eq P[4][3] and Integers()!d mod 3 eq P[4][4] then
S:=[Evaluate(DefiningEquations(C)[i],[a,b,c,d]): i in [1..#DefiningEquations(C)]];
if Integers()!S[1] mod 9 eq 0 and Integers()!S[2] mod 9 eq 0 then [a,b,c,d];
end if;
else continue;
end if;
end for;end for;end for;end for;


//9.27.0.1 x X0(5)

N:=45;
GL2:=GL(2,Integers(N));
G:=sub<GL2|[[7,41,30,13],[16,20,17,9],[24,44,10,3]]>;
Grec:=CreateModularCurveRec(N,Generators(G));
Model:=FindModelOfXG(Grec,27)`psi;
x:=AssociativeArray();
P2:=ProjectiveSpace(FiniteField(7),9);
for i in [1..10] do;
    x[i]:=P2.i;
end for;
C:=Scheme(P2,Model);
Points(C); // empty

//9.27.0.1 x X0(7)

N:=63;
GL2:=GL(2,Integers(N));
G:=sub<GL2|[[5,49,14,5],[7,32,3,4],[31,60,43,59]]>;
Grec:=CreateModularCurveRec(N,Generators(G));
Model:=FindModelOfXG(Grec,27)`psi;
x:=AssociativeArray();
P2:=ProjectiveSpace(FiniteField(2),13);
for i in [1..14] do;
    x[i]:=P2.i;
end for;
C:=Scheme(P2,Model);
Points(C);

//9.27.0.1 x X0(13)

GL2:=GL(2,Integers(9*13));
G:=sub<GL(2,Integers(13))|[[2,2,0,3],[2,6,0,8]]>;
Ggen:=Generators(G);
Red:=hom<GL2->GL(2,Integers(13))|[GL(2,Integers(13))!GL2.i:i in [1..#Generators(GL2)]]>;
Gred:=G@@Red;
G9:=sub<GL(2,Integers(9))|[[0,2,4,1],[4,3,5,4],[4,5,0,5]]>;
G9gen:=Generators(G9);
Red9:=hom<GL2->GL(2,Integers(9))|[GL(2,Integers(9))!GL2.i:i in [1..#Generators(GL2)]]>;
Gred9:=G9@@Red9;
S:={};
H:=Gred9 meet Gred;
Grec:=CreateModularCurveRec(13*9,Generators(H));
 Model:=FindModelOfXG(Grec,27)`psi;
 x:=AssociativeArray();
P2:=ProjectiveSpace(FiniteField(5),25);
for i in [1..26] do;
    x[i]:=P2.i;
end for;
C:=Scheme(P2,Model);
Points(C); // empty
 
